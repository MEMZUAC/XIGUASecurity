<Page
    x:Class="Code_Editor.CodeEditorPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Code_Editor"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- 顶部工具栏 -->
        <AppBar Grid.Row="0" Background="{ThemeResource SystemControlBackgroundChromeMediumBrush}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- 文件操作 -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8">
                    <AppBarButton Icon="NewFolder" Label="新建" ToolTipService.ToolTip="新建文件 (Ctrl+N)"/>
                    <AppBarButton Icon="OpenFile" Label="打开" ToolTipService.ToolTip="打开文件 (Ctrl+O)"/>
                    <AppBarButton Icon="Save" Label="保存" ToolTipService.ToolTip="保存文件 (Ctrl+S)"/>
                    <AppBarButton Icon="SaveLocal" Label="另存为" ToolTipService.ToolTip="另存为 (Ctrl+Shift+S)"/>
                </StackPanel>
                
                <!-- 文件路径 -->
                <TextBox Grid.Column="1" x:Name="FilePathTextBox" Margin="16,0" IsReadOnly="True" 
                         Text="未打开文件" VerticalAlignment="Center"/>
                
                <!-- 编辑操作 -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="8">
                    <AppBarButton Icon="Undo" Label="撤销" ToolTipService.ToolTip="撤销 (Ctrl+Z)"/>
                    <AppBarButton Icon="Redo" Label="重做" ToolTipService.ToolTip="重做 (Ctrl+Y)"/>
                    <AppBarSeparator/>
                    <AppBarButton Icon="Copy" Label="复制" ToolTipService.ToolTip="复制 (Ctrl+C)"/>
                    <AppBarButton Icon="Cut" Label="剪切" ToolTipService.ToolTip="剪切 (Ctrl+X)"/>
                    <AppBarButton Icon="Paste" Label="粘贴" ToolTipService.ToolTip="粘贴 (Ctrl+V)"/>
                </StackPanel>
            </Grid>
        </AppBar>
        
        <!-- 语言选择和状态栏 -->
        <Grid Grid.Row="1" Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}" Padding="16,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <TextBlock Grid.Column="0" Text="语言:" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <ComboBox Grid.Column="1" x:Name="LanguageComboBox" Width="120" SelectedIndex="0">
                <ComboBoxItem Content="C#"/>
                <ComboBoxItem Content="JavaScript"/>
                <ComboBoxItem Content="Python"/>
                <ComboBoxItem Content="XML"/>
                <ComboBoxItem Content="JSON"/>
                <ComboBoxItem Content="文本"/>
            </ComboBox>
            
            <TextBlock Grid.Column="3" x:Name="LineColumnText" Text="行 1, 列 1" VerticalAlignment="Center" Margin="0,0,16,0"/>
            <TextBlock Grid.Column="4" x:Name="EncodingText" Text="UTF-8" VerticalAlignment="Center"/>
        </Grid>
        
        <!-- 代码编辑区域 -->
        <ScrollViewer Grid.Row="2" x:Name="CodeScrollViewer" 
                      HorizontalScrollMode="Enabled" HorizontalScrollBarVisibility="Auto"
                      VerticalScrollMode="Enabled" VerticalScrollBarVisibility="Auto"
                      ZoomMode="Enabled">
            
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- 行号 -->
                <Border Grid.Column="0" x:Name="LineNumbersBorder" 
                        Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}"
                        MinWidth="50" Padding="8,0">
                    <RichTextBlock x:Name="LineNumbersText" IsTextSelectionEnabled="False"
                                   FontFamily="Consolas" FontSize="14" Foreground="Gray"/>
                </Border>
                
                <!-- 代码编辑器 -->
                <RichEditBox Grid.Column="1" x:Name="CodeRichEditBox" 
                             AcceptsReturn="True" TextWrapping="NoWrap"
                             FontFamily="Consolas" FontSize="14"
                             ScrollViewer.HorizontalScrollMode="Enabled" 
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"
                             ScrollViewer.VerticalScrollMode="Enabled" 
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             TextChanged="CodeRichEditBox_TextChanged"
                             SelectionChanged="CodeRichEditBox_SelectionChanged"
                             KeyDown="CodeRichEditBox_KeyDown"/>
            </Grid>
        </ScrollViewer>
        
        <!-- 底部状态栏 -->
        <Grid Grid.Row="3" Background="{ThemeResource SystemControlBackgroundChromeMediumBrush}" Padding="16,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <TextBlock Grid.Column="0" x:Name="StatusText" Text="就绪" VerticalAlignment="Center"/>
            <ProgressBar Grid.Column="1" x:Name="ProgressBar" Height="4" Margin="16,0" Visibility="Collapsed"/>
            <TextBlock Grid.Column="2" x:Name="LengthText" Text="0 字符" VerticalAlignment="Center"/>
        </Grid>
    </Grid>
</Page>